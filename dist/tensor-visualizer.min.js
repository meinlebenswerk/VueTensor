var TensorVisualizer=function(t){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var o=e(t).default.extend({name:"TensorVisualizer",props:{backgroundColor:{type:String,default:"#191919"},foregroundColor:{type:String,default:"#e3e3e3"},tensor:{type:Object,default:function(){return{shape:[6,1,16],data:[]}}},indexType:{type:String,default:"vector"},alphaFalloffConstant:{type:Number,default:4},fillPercentage:{type:Number,default:80},showBoundingBox:{type:Boolean,default:!1}},data:function(){return{ctx2D:null,contextInitialized:!1,canvasCenter:{x:0,y:0},minSize:null,localTensor:{shape:[],data:[]}}},mounted:function(){console.log("Visualizer component mounted:",this.$refs.canvas),this.localTensor=this.tensor;for(var t=this.localTensor.shape.reduce((function(t,e){return e*t})),e=this.localTensor.data.length;e<t;e++)this.localTensor.data.push(Math.random());window.addEventListener("resize",this.setCanvasSize),this.initializeCanvas()},methods:{setCanvasSize:function(){var t=this.$refs.canvas;if(t){var e=t.getBoundingClientRect(),n=e.width,r=e.height;t.width=n,t.height=r,this.canvasCenter={x:n/2,y:r/2},this.minSize=Math.min(n,r),this.redrawCanvas()}},initializeCanvas:function(){var t=this.$refs.canvas;this.ctx2D=null==t?void 0:t.getContext("2d"),this.ctx2D&&t&&(this.contextInitialized=!0,this.setCanvasSize())},redrawCanvas:function(){var t=this.$refs.canvas;if(this.ctx2D&&t&&this.contextInitialized){var e=t.width,n=t.height;this.ctx2D.fillStyle=this.backgroundColor,this.ctx2D.strokeStyle=this.foregroundColor,this.ctx2D.setLineDash([5]),this.ctx2D.fillRect(0,0,e,n),this.drawTensor()}},drawTensor:function(){var t,e=this;if(this.ctx2D&&!(this.localTensor.shape.length>3)){var n=new Array(3).fill(0).map((function(t,n){var r;return null!==(r=e.localTensor.shape[n])&&void 0!==r?r:1})),a=n[0],i=n[1],o=n[2],s=Math.max.apply(Math,r(this.localTensor.data.map((function(t){return t.toFixed(1).length})))),c=(null!==(t=this.minSize)&&void 0!==t?t:0)/100*this.fillPercentage,l=(o-1)/2,d=Math.max(i+l,a+l),h=Math.floor(c/d),f=h/2,u=(h-5)/s;if(this.showBoundingBox){var v=this.ctx2D.strokeStyle;this.ctx2D.strokeStyle="#ff0",this.drawCenteredRect(c,this.canvasCenter),this.ctx2D.strokeStyle=v}for(var p=o-1;p>=0;p-=1){var m=this.isoCenterShift(p,o,f,this.canvasCenter),y=m.x-h*a/2+h/2,x=m.y-h*i/2+h/2,g=227*Math.pow(Math.E,-this.alphaFalloffConstant*(p/o))+32;this.ctx2D.strokeStyle=this.addAlpha(this.foregroundColor,g),this.ctx2D.fillStyle=this.addAlpha(this.foregroundColor,g);for(var b=0;b<a;b+=1)for(var C=0;C<i;C+=1){var S={x:y+h*b,y:x+h*C};this.drawCenteredRect(h,S);var w=(p*a+C)*i+b;this.ctx2D.font="".concat(u/2,"px monospace");var T="";switch(this.indexType){case"vector_base0":T="(".concat(b,", ").concat(C,", ").concat(p,")");break;case"vector":T="(".concat(b+1,", ").concat(C+1,", ").concat(p+1,")");break;case"scalar":T=w.toString();break;case"scalar_hex":T=w.toString(16);break;default:case"none":}"none"!==this.indexType&&this.drawIndex(h,S,T),this.ctx2D.font="".concat(u,"px monospace");var D=this.localTensor.data[w].toFixed(1);this.drawCenteredText(h,S,D)}}}},addAlpha:function(t,e){var n=Math.min(255,Math.floor(e));return"".concat(t).concat(n.toString(16))},isoCenterShift:function(t,e,n,r){var a=t-(e-1)/2;return{x:r.x+a*n,y:r.y-a*n}},drawCenteredRect:function(t,e){var n=this.$refs.canvas;if(this.ctx2D&&n&&this.contextInitialized){var r=t/2;this.ctx2D.strokeRect(e.x-r,e.y-r,t,t)}},drawCenteredText:function(t,e,n){var r=this.$refs.canvas;if(this.ctx2D&&r&&this.contextInitialized){this.ctx2D.textAlign="center";var a=parseInt(this.ctx2D.font.split("px")[0],10);this.ctx2D.fillText(n,e.x,e.y+a/2,t)}},drawIndex:function(t,e,n){var r=this.$refs.canvas;if(this.ctx2D&&r&&this.contextInitialized){var a=t/2;this.ctx2D.textAlign="start";var i=t/20;this.ctx2D.fillText(n,e.x-a+i,e.y+a-i,t)}}},beforeDestroy:function(){window.removeEventListener("resize",this.setCanvasSize)}});function s(t,e,n,r,a,i,o,s,c,l){"boolean"!=typeof o&&(c=s,s=o,o=!1);const d="function"==typeof n?n.options:n;let h;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),r&&(d._scopeId=r),i?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(i)},d._ssrRegister=h):e&&(h=o?function(t){e.call(this,l(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),h)if(d.functional){const t=d.render;d.render=function(e,n){return h.call(n),t(e,n)}}else{const t=d.beforeCreate;d.beforeCreate=t?[].concat(t,h):[h]}return n}const c="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function l(t){return(t,e)=>function(t,e){const n=c?e.media||"default":t,r=h[n]||(h[n]={ids:new Set,styles:[]});if(!r.ids.has(t)){r.ids.add(t);let n=e.source;if(e.map&&(n+="\n/*# sourceURL="+e.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),r.element||(r.element=document.createElement("style"),r.element.type="text/css",e.media&&r.element.setAttribute("media",e.media),void 0===d&&(d=document.head||document.getElementsByTagName("head")[0]),d.appendChild(r.element)),"styleSheet"in r.element)r.styles.push(n),r.element.styleSheet.cssText=r.styles.filter(Boolean).join("\n");else{const t=r.ids.size-1,e=document.createTextNode(n),a=r.element.childNodes;a[t]&&r.element.removeChild(a[t]),a.length?r.element.insertBefore(e,a[t]):r.element.appendChild(e)}}}(t,e)}let d;const h={};var f=s({render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"visualizer-wrapper"},[e("canvas",{ref:"canvas"})])},staticRenderFns:[]},(function(t){t&&t("data-v-1f11d0b2_0",{source:".visualizer-wrapper[data-v-1f11d0b2]{width:100%;height:100%}.visualizer-wrapper canvas[data-v-1f11d0b2]{width:100%;height:100%}",map:void 0,media:void 0})}),o,"data-v-1f11d0b2",false,undefined,!1,l,void 0,void 0),u=function(){var t=f;return t.install=function(e){e.component("TensorVisualizer",t)},t}(),v=Object.freeze({__proto__:null,default:u});return Object.entries(v).forEach((function(t){var e=n(t,2),r=e[0],a=e[1];"default"!==r&&(u[r]=a)})),u}(Vue);